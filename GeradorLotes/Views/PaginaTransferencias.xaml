<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="GeradorLotes.Views.PaginaTransferencias"
    x:Name="View"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:GeradorLotes.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="using:GeradorLotes.Models"
    xmlns:vm="using:GeradorLotes.ViewModels"
    mc:Ignorable="d">

    <Grid Padding="20" RowDefinitions="Auto,Auto,Auto,*,Auto">
        <!-- Título -->
        <TextBlock 
            FontSize="24"
            FontWeight="Bold"
            Margin="0,0,0,20"
            Text="Lote de Transferências" />

        <!-- Msg Sucesso -->
        <InfoBar x:Name="ExportInfoBar"
                 IsOpen="False"
                 Severity="Informational"
                 HorizontalAlignment="Stretch"
                 Margin="0,0,0,10" />

        <!-- Unidade de destino -->
        <StackPanel Orientation="Horizontal" Grid.Row="1" Margin="0,0,0,10">
            <TextBox 
                x:Name="UnidadeDestinoBox"
                Header="Unidade de Destino:"
                MaxLength="10"
                PlaceholderText="Informe o código da unidade de destino"
                Text="{Binding UnidadeDestino, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                Width="320" />
        </StackPanel>

        <!-- Despacho -->
        <StackPanel Orientation="Horizontal" Grid.Row="2" Margin="0,0,0,10">
            <TextBox 
                x:Name="DespachoBox"
                Header="Despacho:"
                PlaceholderText="Informe o texto para despacho de transferência"
                Text="{Binding Despacho, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                Width="320" />
        </StackPanel> 

        <!-- Lista de protocolos -->
        <StackPanel Grid.Row="3">
            <TextBlock Text="Lote de Protocolos:" FontWeight="SemiBold" Margin="0,0,0,5" />
            <ListView 
                Height="300"
                ItemsSource="{x:Bind ViewModel.Protocolos}"
                SelectedItem="{x:Bind ViewModel.ProtocoloSelecionado, Mode=TwoWay}"
                ScrollViewer.VerticalScrollBarVisibility="Auto">
                
                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="models:Protocolo">
                        <TextBlock Text="{x:Bind Numero}" />
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>

            <!-- Painel de adicionar protocolo -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Spacing="10">
                <TextBox 
                    x:Name="ProtocoloBox" 
                    Height="32"
                    KeyDown="ProtocoloBox_KeyDown" 
                    PlaceholderText="Informe um protocolo para adicionar"
                    Text="{Binding ProtocoloDigitado, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                    VerticalAlignment="Center"
                    Width="250" />
                <AppBarButton                  
                    Command="{x:Bind ViewModel.AdicionarCommand}"
                    Icon="Add"
                    Label="Adicionar" />
                <AppBarButton 
                    Command="{x:Bind ViewModel.ExcluirCommand}"
                    CommandParameter="{x:Bind ViewModel.ProtocoloSelecionado, Mode=OneWay}"
                    Icon="Delete"
                    Label="Excluir" />
                <AppBarButton
                    Command="{x:Bind ViewModel.ColarCommand}"
                    Icon="Paste"
                    Label="Colar" />
                <AppBarButton
                    Command="{x:Bind ViewModel.ExportarCommand}"
                    Icon="Save"
                    Label="Exportar" />
            </StackPanel>
        </StackPanel>
    </Grid>
</Page>
